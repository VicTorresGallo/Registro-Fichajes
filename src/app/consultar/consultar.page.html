<ion-header>
  <ion-toolbar>
    <ion-title>Consulta de fichajes</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <!-- Título y selector de fecha -->
  <ion-card>
    <ion-card-content>
      <ion-item>
        <ion-label position="stacked">Selecciona fecha</ion-label>
        <ion-datetime
          presentation="date"
          [(ngModel)]="fechaSeleccionada"
          (ionChange)="filtrarPorFecha()">
        </ion-datetime>
      </ion-item>
    </ion-card-content>
  </ion-card>

  <!-- Si no hay fichajes -->
  <div *ngIf="fichajesFiltrados.length === 0" class="ion-text-center ion-margin-top">
    <ion-icon name="alert-circle-outline" size="large" color="medium"></ion-icon>
    <p>No hay fichajes registrados en esta fecha.</p>
  </div>

  <!-- Lista de fichajes -->
  <ion-list *ngIf="fichajesFiltrados.length > 0">
    <ion-list-header>
      <ion-label>Fichajes del {{ fechaSeleccionada | date:'dd/MM/yyyy' }}</ion-label>
    </ion-list-header>

    <ion-item *ngFor="let f of fichajesFiltrados">
      <ion-icon name="time-outline" slot="start"></ion-icon>
      <ion-label>
        <h2>{{ f.trabajo }}</h2>
        <p>
          <strong>Entrada:</strong> {{ f.fechaHoraEntrada | date:'shortTime' }}<br>
          <strong>Salida:</strong> {{ f.fechaHoraSalida ? (f.fechaHoraSalida | date:'shortTime') : '—' }}<br>
          <strong>Ubicación:</strong> {{ f.latitud }}, {{ f.longitud }}
        </p>
      </ion-label>
      <ion-button fill="clear" size="small" color="primary" (click)="verMapa(f)">
        <ion-icon name="map-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-list>

  <div [routerLink]="['/home']"style="margin-top:12px;display:flex;justify-content:flex-end;">
    <ion-button fill="outline" size="small">Volver</ion-button>
  </div>
</ion-content>
